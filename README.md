# LR1-RBPO

в качестве первого шага созданы /home/user/projects/input и /home/user/projects/output, в input скачан файл с samples.ffmpeg.org, а именно enigma principles из папки FLV

sudo apt-get update

sudo apt-get install -y build-essential python3-dev automake cmake git flex bison libglib2.0-dev libpixman-1-dev python3-setuptools cargo libgtk-3-dev

sudo apt-get install -y lld-14 llvm-14 llvm-14-dev clang-14 || sudo apt-get install -y lld llvm llvm-dev clang

systemctl daemon-reload

sudo apt-get install -y gcc-$(gcc --version|head -n1|sed 's/\..*//'|sed 's/.* //')-plugin-dev libstdc++-$(gcc --version|head -n1|sed 's/\..*//'|sed 's/.* //')-dev

sudo apt-get install -y ninja-build # for QEMU mode

sudo apt-get install -y cpio libcapstone-dev # for Nyx mode

sudo apt-get install -y wget curl # for Frida mode

sudo apt-get install -y python3-pip # for Unicorn mode

cd /home/user/projects

git clone https://github.com/AFLplusplus/AFLplusplus

cd AFLplusplus

make distrib

sudo make install

cd /home/user/projects

git clone https://github.com/FFmpeg/FFmpeg.git

cd FFmpeg

sudo apt install nasm

sudo apt install libmp3lame-dev libopus-dev libvorbis-dev libx264-dev libx265-dev libnuma-dev libass-dev

./configure --prefix="$HOME/ffmpeg_build" --pkg-config-flags="--static" --extra-cflags="-I$HOME/ffmpeg_build/include" --extra-ldflags="-L$HOME/ffmpeg_build/lib" --extra-libs="-lpthread -lm" --bindir="$HOME/bin" --enable-gpl --enable-libass --enable-libfreetype --enable-libmp3lame --enable-libopus --enable-libvorbis --enable-libx264 --enable-libx265 --enable-nonfree --extra-cflags="-I$HOME/ffmpeg_build/include -O1 -fno-omit-frame-pointer -g" --extra-cxxflags="-O1 -fno-omit-frame-pointer -g" --extra-ldflags="-L$HOME/ffmpeg_build/include" --enable-debug

./configure --prefix="$HOME/ffmpeg_build" --pkg-config-flags="--static" --extra-cflags="-I$HOME/ffmpeg_build/include" --extra-ldflags="-L$HOME/ffmpeg_build/lib" --extra-libs="-lpthread -lm" --bindir="$HOME/bin" --enable-gpl --enable-libass --enable-libfreetype --enable-libmp3lame --enable-libopus --enable-libvorbis --enable-libx264 --enable-libx265 --enable-nonfree --cc=afl-clang-fast --cxx=afl-clang-fast++ --extra-cflags="-I$HOME/ffmpeg_build/include -O1 -fno-omit-frame-pointer -g" --extra-cxxflags="-O1 -fno-omit-frame-pointer -g" --extra-ldflags="-L$HOME/ffmpeg_build/include -fsanitize=address -fsanitize=undefined -lubsan" --enable-debug

make

echo core | sudo tee /proc/sys/kernel/core_pattern

afl-fuzz -i /home/user/projects/input/ -o /home/user/projects/output/ -m none -- ./ffmpeg -i @@ test/

скриншоты сделаны почти сразу после запуска и через час работы:
![image](https://github.com/user-attachments/assets/b23f242d-c9ab-406b-a296-091af87a1114)
![image](https://github.com/user-attachments/assets/9cb89fa6-39da-4d18-943b-68da98958f18)

